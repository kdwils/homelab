envoy-proxy-gatekeeper:
  serviceAccount:
    create: true
    automount: false

  deployment:
    create: true
    replicaCount: 2
    deployStrategy: Recreate

    image:
      repository: ghcr.io/kdwils/envoy-proxy-gatekeeper
      tag: v0.0.1
      pullPolicy: IfNotPresent

    env:
      GATEKEEPER_LOGLEVEL: debug
      GATEKEEPER_SERVER_HTTPPORT: 8080
      GATEKEEPER_SERVER_GRPCPORT: 8081
      GATEKEEPER_SERVER_HOST: "gatekeeper.int.kyledev.co"
      GATEKEEPER_CAPTCHA_PROVIDER: turnstile
      GATEKEEPER_CAPTCHA_SITEKEY: "0x4AAAAAAB1bbQbIpIhvAYwl"
      GATEKEEPER_CAPTCHA_COOKIEDOMAIN: kyledev.co
      GATEKEEPER_CAPTCHA_COOKIENAME: kyledev.co
      GATEKEEPER_CAPTCHA_CHALLENGEDURATION: 5m
      GATEKEEPER_CAPTCHA_SESSIONDURATION: 6h

    envFrom:
      - secretRef:
          name: envoy-proxy-gateway

  service:
    create: true
    type: ClusterIP
    ports:
      - name: grpc
        port: 8081
        protocol: TCP
        targetPort: 8080
      - name: http
        port: 8080
        protocol: TCP
        targetPort: 8080

  httproutes:
    - name: gatekeeper-int
      hostnames:
        - gatekeeper.int.kyledev.co
      parentRefs:
        - name: homelab
          namespace: envoy-gateway-system
      rules:
        - backendRefs:
            - group: ""
              kind: Service
              name: envoy-proxy-gatekeeper
              port: 8080

  sealedsecrets:
    - name: envoy-proxy-gatekeeper
      data:
        GATEWAY_CAPTCHA_SECRETKEY: AgABLXPxdKpGvLEMh70q4Nz4vs/VUWG0BgPScey9pQ/WZ07DOyUW5bBVGx+vFNUa+pOsUyee6ngHHvWXDLtVJH2c+WkF+S/RIK1peJGqxX3TkfWQWiGFyZ2YknPT5uzaKrkl593IkSvxKFRWw6hEu4sZJc5eqTORF02uLc6+X+BW4EtJ3F4Ys2WOrGx/Yk3mUQdzIxV4OUqBaWx/80OpXBSXItsZ2NjstlUZ3gq+dOEw/AT2mIc+1/RuAocP93GrDIU5t/78LG439QhvKq//7lFH4q6kc9Xok4j48d73n2Rzh8Xdm0cbFbfJcCcURnvQZ9qErOOeCgVLOsRrOOazNvozXKoDH/VWVCWWxyQ3lWXt1pf+0/XJXBDKrrbE8CsyLOAN5CNIpXvf3y0WSYkBWOWMTM5BflvFZb+nsw4dn7cY2Yo+HsIcv0Skwn6H9picO49iTt0AmlJXqs7LxRlK2zRdvKQA6pz27Ti6UhZ34vD+aQmp302kisZFKrCctPAzP1NRm6sXH6YgU5Kjixa6xTV5R6VrsuistoVSN8uLNOfgGQ66vfW8jwbhP8OPSmCGPRFAKv5HjCzRVHC+Phjb/jNNIWCiFTBa65cNLSJMrtS4eF7I8QOUA5OIutdB58CiQD4wnXeL2ixN6ZDZFW79o+OLBDreFQnjeHr6lNrFPWEfBgXAHrDzEs/r5ukf9zc8tAL4vbEqVr8ebwCFlYJob0Rhowz5Ct2+Tf9UH/bS8lSciLguYQ==
        GATEWAY_CAPTCHA_SIGNINGKEY: AgDGxvG1AMHSRt2C0ktFtVYznOoyGDD1Jy8vy5ay6XG4TW2YKLp6/CFY8PExqdsXwoviiv3RsvFxin4hfFBooNMNwcXZ+tdbg6+p1eW5knyUkFET7T5Hl4PpNFbGRhwqwLcWiQURvXh/TrG1mG0eI9UckLvjtQ6cj4ehBsgR195yIuu6AsosVcCdzse/rhWS0e450LtZNr0r8dOk3f7ZEn37MUBGrZhqHenKrrX6M/D8P+ReDz8+TBq9+K8cH3/5KLqTwoODSXQ0SNXwBCddyFXSRnK5pyO13xFKfn7npMyfaZh0pjzuvNjpehcCb7fpAXf5dJ+mwiQzKAnYMzXp6no2ggQHSAjOLbDRdQhHFicBArGrvoqjhEmwUsg4SomgdsPQcuE+VHKuCSNoxZ9fWGEYom1aN2bHPY4B1pT+RiP791yvGiPMyh2sLr9vI3r+aBaq1ismEnhoUfmAtPPxz5QUTV+DkuSpGB1PQFB25eAeSHEVRJDTkz0o+KHVB+So/Ho2fzsoZyTvK+4HvYWEMwhmuMMIq7+Qiw5lbIC3MJ9T6G/O56BJ8jIcySLqIMiBmcJQvi+uJ3eBXgimQEVRQGfsrctDrLOszGoyhbW7dtUUjne4QAzNxjHSJV+1NKGU7cGmFAwSrxaNl9OjRJwwrVPnzwsaHLXMtG9ifkajZqFIMziOG+ZgH+VdK9uAm6XdHhIdiQwAlJXQYeboP7fe4kHSNV9A/uzpg/9+3L2b/nSA7toe0k9ZIkPId7bME/ayfD4kmf4cL7m8ZistEz1WtBZj
        GATEWAY_TRUSTEDPROXIES: AgCwR4KUrpH9rnh37IYTh7rwn3VO5s3AFTDebhoE9G3UgLmmjCAP+fmIctf4Ydql63o7DVz8edf3aXiPLAbltMoovdxjTkvqB/vldaa+qVLdnZJV2FQMuJaeFrUOgr0o77RuoTmlEE+St+bvjJDYsDp1zXwuwdqJUWV4lOCIaRww6WGj75vKvtfc0aBjyByI/ZMTAhMIHNJ8jUevxVHEKgKNP+gU5UzGByHTOkJqbMG2AevPIi7DVpYFpiqFmdR/YT6712bTATbLfzJzhoLYMGmTSUUC8h2jTJ+QO6GBmuYswDvZM6Q7RtOUiY6/iQOkuxhIX/VYbWENARw9F/ell2yAtgLfDoO8P6XiH/KvZwawrpGRQMEbzzdZ2gbVwgcxZPGgV85kMUOWo1XAisfFq0p+H/+OLHzUNF+neANno0CBVpCCPwAqV41P3DtAtU+OJtFvRtCiS2hWC1jpHUpHOZhLz91OLzR+Fdh4JVokGy6TIIrgUROH8hpom4giophz1EbTwAuPr2bb1U9m4ZE7ovqH+Kg5smmfFc4sNZehEEgtkkR9VHmsvccR2wcVD44snyqiTDmN/wPwuxJBd+5koEt80phgnmeSDN6eUzbEAwyjZqene94wAYoP3a0UdkjdSD8lGOLU7wqAXDSXHonrF9621RSua17JSBf2LXxVnIcXrRHYMkEVDNaGhf9T/+65qz8sJZln3pzlfRv9iaA=
