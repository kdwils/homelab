apiVersion: v1
kind: ConfigMap
metadata:
  name: crowdsec-profiles
data:
  profiles.yaml: |
    name: appsec_ip_remediation
    #debug: true
    filters:
     - Alert.GetScope() == "Ip" && (Alert.GetScenario() contains "appsec" || Alert.GetScenario() contains "vpatch" || Alert.GetScenario() contains "generic-")
    decisions:
     - type: ban
       duration: 4h
    on_success: break
    ---
    name: default_ip_remediation
    #debug: true
    filters:
     - Alert.Remediation == true && Alert.GetScope() == "Ip"
    decisions:
     - type: ban
       duration: 4h
    on_success: break
    ---
    name: default_range_remediation
    #debug: true
    filters:
     - Alert.Remediation == true && Alert.GetScope() == "Range"
    decisions:
     - type: ban
       duration: 4h
    on_success: break
